% This is the script that defines given functions for coupledSystemTest:
% 
% use this file: runShell -funcDefFile=coupledSystemTestFuncDef


% forcing term
fx=2*pi/(xb-xa);
fy=2*pi/(yb-ya);
lambda=1;
if(parameters.isLinear)
    lambda=0;
end

f.phi=@(x,y) -lambda.*((pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.6e1-pi.^2.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*4.8e1).*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(ya-yb).^2.*1.6e1-pi.^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(ya-yb).^2.*4.8e1)-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^6.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^6.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*4.096e3)-pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^4.*1.04e3-pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(ya-yb).^4.*1.04e3-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^4.*1.92e3-pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).*1.0./(ya-yb).^4.*1.92e3-pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*8.0e2-pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).*sin((pi.*(y-ya).*2.0)./(ya-yb)).*1.0./(ya-yb).^2.*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.6e1-pi.^2.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*4.8e1).*4.0-pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).*sin((pi.*(y-ya).*2.0)./(ya-yb)).*1.0./(xa-xb).^2.*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(ya-yb).^2.*1.6e1-pi.^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(ya-yb).^2.*4.8e1).*4.0+pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^3.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^4.*7.04e3+pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^3.*1.0./(ya-yb).^4.*7.04e3+pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^3.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*3.2e3+pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^3.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*3.2e3-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^3.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^3.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*1.2288e4;
f.w=@(x,y)-lambda.*((pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.6e1-pi.^2.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*4.8e1).*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(ya-yb).^2.*2.0e1-pi.^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^3.*1.0./(ya-yb).^2.*8.0e1)+(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*2.0e1-pi.^2.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^3.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*8.0e1).*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(ya-yb).^2.*1.6e1-pi.^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(ya-yb).^2.*4.8e1)-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^7.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^7.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*1.28e4)+pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^4.*3.84e2+pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*1.0./(ya-yb).^4.*3.84e2+pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^4.*6.4e2+pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(ya-yb).^4.*6.4e2+pi.^4.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*5.12e2-pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).*sin((pi.*(y-ya).*2.0)./(ya-yb)).*1.0./(ya-yb).^2.*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*2.0e1-pi.^2.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^3.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(xa-xb).^2.*8.0e1).*4.0-pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).*sin((pi.*(y-ya).*2.0)./(ya-yb)).*1.0./(xa-xb).^2.*(pi.^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^5.*1.0./(ya-yb).^2.*2.0e1-pi.^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^5.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^3.*1.0./(ya-yb).^2.*8.0e1).*4.0-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^4.*3.072e3-pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(ya-yb).^4.*3.072e3-pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*1.536e3-pi.^4.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*1.536e3+pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^2.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^2.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*4.608e3+pi.^4.*cos((pi.*(x-xa).*2.0)./(xa-xb)).^2.*cos((pi.*(y-ya).*2.0)./(ya-yb)).^2.*sin((pi.*(x-xa).*2.0)./(xa-xb)).^4.*sin((pi.*(y-ya).*2.0)./(ya-yb)).^4.*1.0./(xa-xb).^2.*1.0./(ya-yb).^2.*8.0e2;
%exact solution is known for this test
knownExactSolution=true;
exact.w=@(x,y) (sin(fx*(x-xa)).*sin(fy*(y-ya))).^4;
exact.phi=@(x,y) (sin(fx*(x-xa)).*sin(fy*(y-ya))).^5;

% initial shell shape: w0(x,y).
w0=@(x,y) (sin(fx*(x-xa)).*sin(fy*(y-ya)));